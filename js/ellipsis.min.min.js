!function(){"use strict";function i(e){e=function(e,i){var t={},n,s;for(n in e)t[n]=e[n];for(s in i)t[s]=i[s];return t}(t,e||{});this.create(e),this.add()}function n(e,i){var t=s+=1;i.setAttribute("data-ellipsis-id",t),e[t]=e[t]||{},e[t].element=i,e[t].innerHTML=i.innerHTML}function l(t){return Object.keys(t).map(function(e,i){return t[e].element})}function e(e){return new i(e)}var t={ellipsis:"â€¦",debounce:0,responsive:!0,className:".clamp",lines:2,portrait:null,break_word:!0},s=0,o=!!window.requestAnimationFrame;i.prototype={conf:{},prop:{},lines:{},temp:null,listener:null,create:function(e){var i,t,n,s;this.conf=e,this.lines={get current(){return e.portrait&&window.innerHeight>window.innerWidth?e.portrait:e.lines}},this.conf.responsive&&(this.temp={},s=this.conf.debounce,t=o&&!s?(this._isScheduled=!1,i=this,function(e){i._isScheduled||(i._isScheduled=!0,window.requestAnimationFrame(function(){i._isScheduled=!1,i.add(l(i.temp))}))}):(s=s||16,function(e){clearTimeout(n),n=setTimeout(function(){this.add(l(this.temp))}.bind(this),s)}),this.listener=t.bind(this),window.addEventListener("resize",this.listener,!1),window.removeEventListener("beforeunload",this.listener,!1))},destroy:function(){this.listener&&window.removeEventListener("resize",this.listener,!1)},createProp:function(i){this.prop={get height(){var e=i.getBoundingClientRect();return parseInt(e.bottom-e.top,10)},get lineheight(){var e=getComputedStyle(i).getPropertyValue("line-height");return-1<String("normal|initial|inherit").indexOf(e)&&(e=parseInt(getComputedStyle(i).getPropertyValue("font-size"),10)+2),parseInt(e,10)}}},add:function(e){if(e=!e&&this.conf.className?document.querySelectorAll(this.conf.className):e)if(e.length)for(var i=0;i<e.length;i++)this.addElement(e[i]);else void 0===e.length&&this.addElement(e)},addElement:function(e){var i,t;this.conf.responsive&&(i=this.temp,t=e,(i=i?i[t.getAttribute("data-ellipsis-id")]:null)?e.innerHTML!==i.innerHTML&&(e.innerHTML=i.innerHTML):n(this.temp,e)),this.createProp(e),this.isNotCorrect()&&(e.childNodes.length&&1<e.childNodes.length?this.handleChildren(e):e.childNodes.length&&1===e.childNodes.length&&3===e.childNodes[0].nodeType&&this.simpleText(e))},breakWord:function(e,i,t){e=e.split(" ");return e.pop(),t&&e.pop(),i?e[e.length-1]?(e[e.length-1]=e[e.length-1].replace(/(,$)/g,"").replace(/(\.$)/g,""),e.push(this.conf.ellipsis),[e.join(" "),i]):!e[e.length-1]&&i?(t=" "+i.trim().replace(/(,$)/g,"").replace(/(\.$)/g,"")+" ",e.push(this.conf.ellipsis),[e.join(" "),t]):void 0:(e[e.length-1]&&(e[e.length-1]=e[e.length-1].replace(/(,$)/g,"").replace(/(\.$)/g,"")),e.push(this.conf.ellipsis),e.join(" "))},simpleText:function(e){for(var i=e.childNodes[0].nodeValue;this.prop.height>this.prop.lineheight*this.lines.current;)e.childNodes[0].nodeValue=i.slice(0,-1),i=e.childNodes[0].nodeValue;this.conf.break_word?(e.childNodes[0].nodeValue=i.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis,this.isNotCorrect()&&(e.childNodes[0].nodeValue=" "+e.childNodes[0].nodeValue.slice(0,-(this.conf.ellipsis.length+1)).trim().slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis)):(e.childNodes[0].nodeValue=this.breakWord(e.childNodes[0].nodeValue),this.isNotCorrect()&&(e.childNodes[0].nodeValue=this.breakWord(e.childNodes[0].nodeValue,null,!0)))},isNotCorrect:function(){return this.prop.height>this.prop.lineheight*this.lines.current},processBreak:function(e,i,t){t=this.breakWord(e.innerText||e.nodeValue,i.innerText||i.nodeValue,t);e.innerText?e.innerText=t[0]:e.nodeValue=t[0],i.innerText?i.innerText=t[1]:i.nodeValue=t[1]},handleChildren:function(e){for(var i,t,n=e.childNodes,s=n.length-1;0<=s;s--)if(8!==n[s].nodeType){if(3===n[s].nodeType?(t=n[s].nodeValue,n[s].nodeValue=""):(t=getComputedStyle(n[s]).getPropertyValue("display"),n[s].style.display="none"),this.prop.height<=this.prop.lineheight*this.lines.current){if(3===n[s].nodeType){for(n[s].nodeValue=t,i=n[s].nodeValue;this.prop.height>this.prop.lineheight*this.lines.current;)n[s].nodeValue=i.slice(0,-1),i=n[s].nodeValue;if(this.conf.break_word){if(n[s].nodeValue=i.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis,this.isNotCorrect()){if(n[s].nodeValue=" "+n[s].nodeValue.slice(0,-this.conf.ellipsis.length).trim().slice(0,-this.conf.ellipsis.length),!(1<n[s].nodeValue.length))continue;n[s].nodeValue=n[s].nodeValue.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis}}else{if(!n[s].innerText&&!n[s].nodeValue)continue;if(this.processBreak(n[s],n[s-1]),this.isNotCorrect()&&(this.processBreak(n[s],n[s-1],!0),this.isNotCorrect())){e.removeChild(n[s]);continue}}}else{for(n[s].style.display=t,i=n[s].innerText;this.prop.height>this.prop.lineheight*this.lines.current;)n[s].innerText=i.slice(0,-1),i=n[s].innerText;if(this.conf.break_word){if(n[s].innerText=i.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis,this.isNotCorrect()){if(n[s].innerText=" "+n[s].innerText.slice(0,-this.conf.ellipsis.length).trim().slice(0,-this.conf.ellipsis.length),!(1<n[s].innerText.length))continue;n[s].innerText=n[s].innerText.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis}}else{if(!n[s].innerText&&!n[s].nodeValue)continue;if(this.processBreak(n[s],n[s-1]),this.isNotCorrect()&&(this.processBreak(n[s],n[s-1],!0),this.isNotCorrect())){e.removeChild(n[s]);continue}}}break}e.removeChild(n[s])}}};"function"==typeof define&&define.amd&&define("ellipsis",[],function(){return e}),self.Ellipsis=e}();